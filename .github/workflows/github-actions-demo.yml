name: 🌟 Унікальний CI/CD Workflow 🌈

on: [push]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node-version: [ 14.x, 16.x]
    steps:
    - uses: actions/checkout@v2
    - name: 🎉 Встановлення Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v2
      with:
        node-version: ${{ matrix.node-version }}
    - name: 🚀 Встановлення залежностей
      run: npm install
    - name: 🌐 Запуск тестів
      run: npm run test    
    - name: 📊 Відправка звіту про покриття коду тестами в Coveralls
      uses: coverallsapp/github-action@master
      with:
        github-token: ${{ secrets.GITHUB_TOKEN }}
    - name: 🎨 Генерація статусу з креативними емодзі
      run: "echo 'Статус білду: 🟢 УСПІХ або 🔴 ПОМИЛКА'"
    - name: 📦 Білд додатку
      run: npm run build
    - name: 🚢 Деплоймент на GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./build
    - name: 📢 Сповіщення про успішний деплой
      uses: actions/github-script@v3
      with:
        script: |
          github.issues.createComment({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: '🚀 Деплой завершено! Перевірте ваш [GitHub Pages](https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}) 🌐'
          })
